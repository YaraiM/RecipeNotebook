{"openapi":"3.0.1","info":{"title":"レシピノートAPI仕様","description":"レシピノートアプリのAPI仕様書です。APIの動作確認を行う場合は、Basic認証およびCSRFトークンの送信が必要です。","license":{"name":"Apache License 2.0","url":"https://www.apache.org/licenses/LICENSE-2.0.txt"},"version":"0.1.0"},"servers":[{"url":"http://localhost:8080","description":"Development Server"},{"url":"-","description":"Production Server"}],"security":[{"basicAuth":[]},{"csrfToken":[]}],"paths":{"/api/recipes/{id}/update":{"put":{"tags":["recipe-api-controller"],"summary":"レシピの更新","description":"既存情報の変更や材料・調理手順の追加・削除を行います。","operationId":"updateRecipeDetail","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"description":"レシピ詳細情報および画像データ（base64形式）です。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetailWithImageData"},"example":{"recipeDetail":{"recipe":{"id":1,"name":"卵焼き（アレンジver.）","imagePath":"/images/tamagoyaki.jpg","recipeSource":"https://------1.com","servings":"2人分","remark":"アレンジ版の卵焼きのレシピです。砂糖の代わりに白だしを加えます","favorite":false},"ingredients":[{"id":1,"name":"卵","quantity":"3個","arrange":false},{"id":2,"name":"サラダ油","quantity":"適量","arrange":false},{"id":3,"name":"醤油","quantity":"大さじ1/2","arrange":false},{"id":null,"name":"白だし","quantity":"小さじ1/2","arrange":true}],"instructions":[{"id":1,"stepNumber":1,"content":"卵を溶いて調味料を混ぜ、卵液を作る","arrange":false},{"id":2,"stepNumber":2,"content":"フライパンに油をたらし、火にかける","arrange":false},{"id":3,"stepNumber":3,"content":"卵液を1/3くらいフライパンに入れて焼き、巻く","arrange":true},{"id":4,"stepNumber":4,"content":"3の手順を繰り返して完成","arrange":false}]},"imageData":null}}},"required":true},"responses":{"400":{"description":"許可されていないリクエスト（▽必須項目の未入力、▽画像以外のデータのアップロード、▽5MBを超える画像データのアップロード、▽パスとリクエストパラメータにおけるレシピIDの不一致）をリクエストした場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"BAD_REQUEST","message":"バリデーションエラーです。入力フォームを確認してください","errors":[{"field":"recipeDetail.ingredients[0].name","message":"空白は許可されていません"},{"field":"recipeDetail.recipe.name","message":"空白は許可されていません"}]}}}},"404":{"description":"データベースに存在しないIDを指定した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"NOT_FOUND","message":"レシピID「999」は存在しません","errors":null}}}},"200":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetail"},"example":{"recipe":{"id":1,"name":"卵焼き（アレンジver.）","imagePath":"/images/tamagoyaki.jpg","recipeSource":"https://------1.com","servings":"2人分","remark":"アレンジ版の卵焼きのレシピです。砂糖の代わりに白だしを加えます","favorite":false},"ingredients":[{"id":1,"recipeId":1,"name":"卵","quantity":"3個","arrange":false},{"id":2,"recipeId":1,"name":"サラダ油","quantity":"適量","arrange":false},{"id":3,"recipeId":1,"name":"醤油","quantity":"大さじ1/2","arrange":false},{"id":5,"recipeId":1,"name":"白だし","quantity":"小さじ1/2","arrange":true}],"instructions":[{"id":1,"recipeId":1,"stepNumber":1,"content":"卵を溶いて調味料を混ぜ、卵液を作る","arrange":false},{"id":2,"recipeId":1,"stepNumber":2,"content":"フライパンに油をたらし、火にかける","arrange":false},{"id":3,"recipeId":1,"stepNumber":3,"content":"卵液を1/3くらいフライパンに入れて焼き、巻く","arrange":true},{"id":4,"recipeId":1,"stepNumber":4,"content":"3の手順を繰り返して完成","arrange":false}]}}}}}}},"/api/recipes/{id}/favorite":{"put":{"tags":["recipe-api-controller"],"summary":"レシピのお気に入りフラグの更新","description":"指定したIDに紐づくレシピのお気に入りフラグ（favorite）の更新を行います。","operationId":"updateFavoriteStatus","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"description":"レシピIDとお気に入りフラグ（favorite）です。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetailWithImageData"},"example":{"id":1,"favorite":true}}},"required":true},"responses":{"200":{"description":"処理が成功した場合のレスポンスです。","content":{"*/*":{"schema":{"type":"string","example":"お気に入りを変更しました"}}}},"404":{"description":"データベースに存在しないIDを指定した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"NOT_FOUND","message":"レシピID「999」は存在しません","errors":null}}}}}}},"/api/recipes/new":{"post":{"tags":["recipe-api-controller"],"summary":"レシピの新規作成","description":"入力した情報に基づきレシピを新規作成するとともに、そのレシピへのパスを作成します。","operationId":"createRecipeDetail","requestBody":{"description":"レシピ詳細情報および画像データ（base64形式）です。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetailWithImageData"},"example":{"recipeDetail":{"recipe":{"name":"炒り卵","imagePath":"test3/path","recipeSource":"https://------3.com","servings":"3人分","remark":"基本の炒り卵のレシピです。","favorite":false},"ingredients":[{"name":"卵","quantity":"3個","arrange":false},{"name":"サラダ油","quantity":"適量","arrange":false},{"name":"マヨネーズ","quantity":"大さじ2","arrange":true},{"name":"砂糖","quantity":"大さじ1/2","arrange":false}],"instructions":[{"stepNumber":1,"content":"卵を溶いて調味料を混ぜ、卵液を作る","arrange":false},{"stepNumber":2,"content":"フライパンに油をたらし、火にかける","arrange":false},{"stepNumber":3,"content":"卵液をフライパンに入れて焼きながらかき混ぜて完成","arrange":false}]},"imageData":null}}},"required":true},"responses":{"400":{"description":"許可されていないリクエスト（▽必須項目の未入力、▽画像以外のデータのアップロード、▽5MBを超える画像データのアップロード）をリクエストした場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"BAD_REQUEST","message":"バリデーションエラーです。入力フォームを確認してください","errors":[{"field":"recipeDetail.ingredients[0].name","message":"空白は許可されていません"},{"field":"recipeDetail.recipe.name","message":"空白は許可されていません"}]}}}},"201":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetail"},"example":{"recipe":{"id":3,"name":"炒り卵","imagePath":"test3/path","recipeSource":"https://------3.com","servings":"3人分","remark":"基本の炒り卵のレシピです。","favorite":false},"ingredients":[{"id":8,"recipeId":3,"name":"卵","quantity":"3個","arrange":false},{"id":9,"recipeId":3,"name":"サラダ油","quantity":"適量","arrange":false},{"id":10,"recipeId":3,"name":"マヨネーズ","quantity":"大さじ2","arrange":true},{"id":11,"recipeId":3,"name":"砂糖","quantity":"大さじ1/2","arrange":false}],"instructions":[{"id":8,"recipeId":3,"stepNumber":1,"content":"卵を溶いて調味料を混ぜ、卵液を作る","arrange":false},{"id":9,"recipeId":3,"stepNumber":2,"content":"フライパンに油をたらし、火にかける","arrange":false},{"id":10,"recipeId":3,"stepNumber":3,"content":"卵液をフライパンに入れて焼きながらかき混ぜて完成","arrange":false}]}}}}}}},"/api/login/guest":{"post":{"tags":["login-controller"],"summary":"ゲストログインの実行","description":"ゲストログインを行います。","operationId":"guestLogin","responses":{"200":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"example":{"message":"ログイン成功"}}}},"401":{"description":"ゲストログインに認証に失敗した場合のレスポンスです。","content":{"application/json":{"example":{"message":"ゲストログインに失敗しました。もう一度お試しください"}}}}}}},"/csrf-token":{"get":{"tags":["csrf-controller"],"summary":"CSRFトークンの取得","description":"SpringSecurityの機能でCSRFトークンを取得します。","operationId":"getCsrfToken","responses":{"200":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"example":{"token":"token1234","headerName":"X-CSRF-TOKEN"}}}}}}},"/api/recipes":{"get":{"tags":["recipe-api-controller"],"summary":"レシピの一覧検索","description":"RecipeSearchCriteriaで定義するリクエストパラメータに応じたレシピ検索を行います。リクエストパラメータが全てnullの場合は全件検索を行います。","operationId":"searchRecipeDetails","parameters":[{"name":"recipeSearchCriteria","in":"query","required":true,"schema":{"$ref":"#/components/schemas/RecipeSearchCriteria"}}],"responses":{"400":{"description":"不正な検索条件を指定した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"BAD_REQUEST","message":"バリデーションエラーです。入力フォームを確認してください","errors":[{"field":"createDateTo","message":"終了日が開始日より前の日付になっています"}]}}}},"200":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RecipeDetail"}},"example":[{"recipe":{"id":2,"name":"目玉焼き","imagePath":"/images/medamayaki.jpg","recipeSource":"https://------2.com","servings":"1人前","remark":"基本の目玉焼きのレシピです。","favorite":true,"createdAt":"2024-09-23T17:00:00","updatedAt":"2024-10-23T17:00:00"},"ingredients":[{"id":5,"recipeId":2,"name":"卵","quantity":"1個","arrange":false},{"id":6,"recipeId":2,"name":"サラダ油","quantity":"適量","arrange":false},{"id":7,"recipeId":2,"name":"水","quantity":null,"arrange":false}],"instructions":[{"id":5,"recipeId":2,"stepNumber":1,"content":"フライパンに油をたらし、火にかける","arrange":false},{"id":6,"recipeId":2,"stepNumber":2,"content":"フライパンに卵を割り入れる","arrange":false},{"id":7,"recipeId":2,"stepNumber":3,"content":"少し焼けたら水を入れ、ふたをして5分、弱火にかけて完成","arrange":false}]}]}}}}}},"/api/recipes/{id}":{"get":{"tags":["recipe-api-controller"],"summary":"レシピ詳細情報の取得","description":"指定したIDのレシピの詳細情報を取得します。","operationId":"getRecipeDetail","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"処理が成功した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecipeDetail"},"example":[{"recipe":{"id":2,"name":"目玉焼き","imagePath":"/images/medamayaki.jpg","recipeSource":"https://------2.com","servings":"1人前","remark":"基本の目玉焼きのレシピです。","favorite":true,"createdAt":"2024-09-23T17:00:00","updatedAt":"2024-10-23T17:00:00"},"ingredients":[{"id":5,"recipeId":2,"name":"卵","quantity":"1個","arrange":false},{"id":6,"recipeId":2,"name":"サラダ油","quantity":"適量","arrange":false},{"id":7,"recipeId":2,"name":"水","quantity":null,"arrange":false}],"instructions":[{"id":5,"recipeId":2,"stepNumber":1,"content":"フライパンに油をたらし、火にかける","arrange":false},{"id":6,"recipeId":2,"stepNumber":2,"content":"フライパンに卵を割り入れる","arrange":false},{"id":7,"recipeId":2,"stepNumber":3,"content":"少し焼けたら水を入れ、ふたをして5分、弱火にかけて完成","arrange":false}]}]}}},"404":{"description":"データベースに存在しないIDを指定した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"NOT_FOUND","message":"レシピID「999」は存在しません","errors":null}}}}}}},"/api/recipes/{id}/delete":{"delete":{"tags":["recipe-api-controller"],"summary":"レシピの削除","description":"指定したIDに紐づくレシピをデータベースから削除します。レシピIDに紐づく材料および調理手順もデータベースから削除します。","operationId":"deleteRecipeDetail","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"404":{"description":"データベースに存在しないIDを指定した場合のレスポンスです。","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"status":"NOT_FOUND","message":"レシピID「999」は存在しません","errors":null}}}},"200":{"description":"処理が成功した場合のレスポンスです。","content":{"*/*":{"schema":{"type":"string","example":"レシピを削除しました"}}}}}}}},"components":{"schemas":{"Ingredient":{"required":["name"],"type":"object","properties":{"id":{"type":"integer","format":"int32"},"recipeId":{"type":"integer","format":"int32"},"name":{"type":"string"},"quantity":{"type":"string"},"arrange":{"type":"boolean"}},"description":"レシピの材料"},"Instruction":{"required":["content"],"type":"object","properties":{"id":{"type":"integer","format":"int32"},"recipeId":{"type":"integer","format":"int32"},"stepNumber":{"type":"integer","format":"int32"},"content":{"type":"string"},"arrange":{"type":"boolean"}},"description":"レシピの調理手順"},"Recipe":{"required":["name"],"type":"object","properties":{"id":{"type":"integer","format":"int32"},"userId":{"type":"integer","format":"int32"},"name":{"type":"string"},"imagePath":{"type":"string"},"recipeSource":{"type":"string"},"servings":{"type":"string"},"remark":{"type":"string"},"favorite":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}},"description":"レシピ"},"RecipeDetail":{"type":"object","properties":{"recipe":{"$ref":"#/components/schemas/Recipe"},"ingredients":{"type":"array","items":{"$ref":"#/components/schemas/Ingredient"}},"instructions":{"type":"array","items":{"$ref":"#/components/schemas/Instruction"}}},"description":"レシピ詳細情報"},"RecipeDetailWithImageData":{"type":"object","properties":{"recipeDetail":{"$ref":"#/components/schemas/RecipeDetail"},"imageData":{"type":"string"}},"description":"レシピ詳細情報＋画像データ（Base64）"},"ErrorResponse":{"type":"object","properties":{"status":{"type":"string","enum":["100 CONTINUE","101 SWITCHING_PROTOCOLS","102 PROCESSING","103 EARLY_HINTS","103 CHECKPOINT","200 OK","201 CREATED","202 ACCEPTED","203 NON_AUTHORITATIVE_INFORMATION","204 NO_CONTENT","205 RESET_CONTENT","206 PARTIAL_CONTENT","207 MULTI_STATUS","208 ALREADY_REPORTED","226 IM_USED","300 MULTIPLE_CHOICES","301 MOVED_PERMANENTLY","302 FOUND","302 MOVED_TEMPORARILY","303 SEE_OTHER","304 NOT_MODIFIED","305 USE_PROXY","307 TEMPORARY_REDIRECT","308 PERMANENT_REDIRECT","400 BAD_REQUEST","401 UNAUTHORIZED","402 PAYMENT_REQUIRED","403 FORBIDDEN","404 NOT_FOUND","405 METHOD_NOT_ALLOWED","406 NOT_ACCEPTABLE","407 PROXY_AUTHENTICATION_REQUIRED","408 REQUEST_TIMEOUT","409 CONFLICT","410 GONE","411 LENGTH_REQUIRED","412 PRECONDITION_FAILED","413 PAYLOAD_TOO_LARGE","413 REQUEST_ENTITY_TOO_LARGE","414 URI_TOO_LONG","414 REQUEST_URI_TOO_LONG","415 UNSUPPORTED_MEDIA_TYPE","416 REQUESTED_RANGE_NOT_SATISFIABLE","417 EXPECTATION_FAILED","418 I_AM_A_TEAPOT","419 INSUFFICIENT_SPACE_ON_RESOURCE","420 METHOD_FAILURE","421 DESTINATION_LOCKED","422 UNPROCESSABLE_ENTITY","423 LOCKED","424 FAILED_DEPENDENCY","425 TOO_EARLY","426 UPGRADE_REQUIRED","428 PRECONDITION_REQUIRED","429 TOO_MANY_REQUESTS","431 REQUEST_HEADER_FIELDS_TOO_LARGE","451 UNAVAILABLE_FOR_LEGAL_REASONS","500 INTERNAL_SERVER_ERROR","501 NOT_IMPLEMENTED","502 BAD_GATEWAY","503 SERVICE_UNAVAILABLE","504 GATEWAY_TIMEOUT","505 HTTP_VERSION_NOT_SUPPORTED","506 VARIANT_ALSO_NEGOTIATES","507 INSUFFICIENT_STORAGE","508 LOOP_DETECTED","509 BANDWIDTH_LIMIT_EXCEEDED","510 NOT_EXTENDED","511 NETWORK_AUTHENTICATION_REQUIRED"]},"message":{"type":"string"},"errors":{"type":"array","items":{"type":"object","additionalProperties":{"type":"string"}}}},"description":"例外発生時のレスポンス"},"RecipeSearchCriteria":{"type":"object","properties":{"recipeNames":{"type":"array","description":"レシピ名で検索します。複数のキーワードを指定可能です。","example":["目玉","焼"],"items":{"type":"string","description":"レシピ名で検索します。複数のキーワードを指定可能です。","example":"[\"目玉\",\"焼\"]"}},"favoriteRecipe":{"type":"boolean","description":"お気に入りのレシピで絞り込みます。","example":false},"createDateFrom":{"type":"string","description":"作成日（指定日以降）で検索します","format":"date","example":"2024-01-01"},"createDateTo":{"type":"string","description":"作成日（指定日以前）で検索します","format":"date","example":"2025-01-01"},"updateDateFrom":{"type":"string","description":"更新日（指定日以降）で検索します","format":"date","example":"2024-07-01"},"updateDateTo":{"type":"string","description":"作成日（指定日以前）で検索します","format":"date","example":"2025-07-01"},"ingredientNames":{"type":"array","description":"指定した材料が含まれるレシピを検索します。複数のキーワードを指定可能です。","example":["卵","水"],"items":{"type":"string","description":"指定した材料が含まれるレシピを検索します。複数のキーワードを指定可能です。","example":"[\"卵\",\"水\"]"}}},"description":"レシピ検索時に指定可能なパラメータ"}},"securitySchemes":{"basicAuth":{"type":"http","scheme":"basic"},"csrfToken":{"type":"apiKey","name":"X-CSRF-TOKEN","in":"header"}}}}